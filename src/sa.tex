% overview +
% complexity +
% code snippet +
% measurements +
% table +

Для анализа работы структуры данных взят suffix array из стандартной библиотеки языка Go.
% https://golang.org/pkg/index/suffixarray/
Он принимает на вход текст и составляет из него отсортированный индекс, с помощью которого можно осуществлять
операции поиска подстроки. Создание индекса занимает $O(n)$ операций, где $n$ -- размер исходного текста.
Поиск подстроки занимает $O(\log n \cdot |s|)$, где $|s|$ -- это длина искомой подстроки.
Рассмотрим подробнее бенчмарки. Исходный текст загружается из файла, затем выбирается подстрока
из исходного текста, ограниченная позициями $[leftPos:rigtPos]$.

\begin{lstlisting}[caption=Suffix array example]
func BenchmarkLookup(b *testing.B, testStr []byte) {
    sa := suffixarray.New(testStr)
    b.ResetTimer()
    for i := 0; i < b.N; i++ {
        offset := sa.Lookup(testStr[leftPos: rightPos], -1)
        if len(offset) < 1 || offset[0] != leftPos {
            b.Fatalf("mis-match: %v", offset)
        }
    }
}
\end{lstlisting}

На листинге 1 показан упрощенный код бенчмарка поиска подстроки для suffix array
(маловажные для общего понимания детали опущены). Код протестирован для 5 текстов разного содержания.
Размер подстроки для поиска данных является одинаковым для каждого измерения.

\begin{table}[h!]
    \centering
    \begin{tabular}{|c|c|c|}
        \hline
        Размер текста, KB & Память, KB & Время, s\\
        \hline
        9766 & 58741 & 1.832\\
        \hline
        977 & 6020 & 0.337\\
        \hline
        879 & 5457 & 0.333\\
        \hline
        782 & 4838 & 0.323\\
        \hline
        684 & 4252 & 0.314\\
        \hline
        586 & 3669 & 0.305\\
        \hline
        489 & 3589 & 0.297\\
        \hline
        391 & 2925 & 0.285\\
        \hline
        293 & 2244 & 0.275\\
        \hline
        196 & 1563 & 0.274\\
        \hline
        98 & 881 & 0.260\\
        \hline
        49 & 547 & 0.258\\
        \hline
        10 & 246 & 0.252\\
        \hline
        5 & 212 & 0.251\\
        \hline
        2 & 194 & 0.256\\
        \hline
    \end{tabular}
    \caption{Построение suffix array}
    \label{table:2}
\end{table}

Т.к. размер suffix array не зависит от размера алфавита,
результаты для разных текстов отличаются в пределах погрешности измерения,
поэтому для наглядности достаточно привести пример для одного типа текста.
В таблице \ref{table:2} показаны результаты измерений построения индекса для Amazon Text Corpora.

% size, kb: 977, 879, 782, 684, 586, 489, 391, 293, 196, 98
% time, mks: 12251, 11857, 12331, 12969, 12777, 12680, 11795, 11555, 11752, 11657
% mem, kb:  6101, 5501, 4915, 4333, 3747, 3707, 3001, 2322, 1642, 962

\begin{table}[h!]
    \centering
    \begin{tabular}{|c|c|c|}
        \hline
        Размер текста, KB & Память, KB & Время, ms\\
        \hline
        977 & 6020 & 12.251\\
        \hline
        879 & 5457 & 11.857\\
        \hline
        782 & 4838 & 12.331\\
        \hline
        684 & 4252 & 12.969\\
        \hline
        586 & 3669 & 12.777\\
        \hline
        489 & 3589 & 12.680\\
        \hline
        391 & 2925 & 11.795\\
        \hline
        293 & 2244 & 11.555\\
        \hline
        196 & 1563 & 11.752\\
        \hline
        98 & 881 & 11.657\\
        \hline
    \end{tabular}
    \caption{Поиск подстроки в suffix array}
    \label{table:3}
\end{table}
